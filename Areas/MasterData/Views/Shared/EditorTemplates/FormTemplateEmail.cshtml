@model AKR_LANDED_COST_FAME.Areas.MasterData.Models.TemplateEmailViewModel

@(Html.Kendo().DataSource<System.Web.Mvc.SelectListItem>()
    .Name("DSFieldCode")
    .Custom(s => s
        .Transport(t => t
            .Read(read => read.Action("GetEmailSnippetSelectListItems", "Config", new { Area = string.Empty }).Data("ParamFieldCode"))
        )
        .ServerFiltering(true)
        .Group(g => g.Add("Group.Name", typeof(string)))
    )
)
<div class="content">
    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
    <div class="form-horizontal form-widgets">
        <div class="form-group">
            <label class="control-label col-sm-2">Menu</label>
            <div class="col-sm-4 col-md-4">
                @(Html.Kendo().DropDownListFor(m => m.MenuID)
                    .Filter(FilterType.Contains)
                    .DataValueField("MenuID")
                    .DataTextField("MenuName")
                    .DataSource(source =>
                    {
                        source.Read(read =>
                        {
                            read.Action("SelectListMenu", "TemplateEmail");
                        })
                        .ServerFiltering(false);
                    })
                    .Events(e=>e.Change("OnSelect"))
                    .HtmlAttributes(new { style = "width:100%"}))
            </div>
            <label class="control-label col-sm-2">Email Type</label>
            <div class="col-sm-4 col-md-4">
                @(Html.Kendo().DropDownListFor(m => m.Type)
                    .Filter(FilterType.Contains)
                    .DataValueField("Value")
                    .DataTextField("Text")
                    .DataSource(source =>
                    {
                        source.Read(read =>
                        {
                            read.Action("SelectListEmailType", "TemplateEmail");
                        })
                        .ServerFiltering(true);
                    })
                    .HtmlAttributes(new { style = "width:100%"}))
            </div>
        </div>
        <div class="form-group">
            <label class="control-label col-sm-2">Mail TO</label>
            <div class="col-sm-4 col-md-4">
                @(Html.Kendo().MultiSelectFor(m => m.ListMailTO)
                    .Filter(FilterType.Contains)
                    .DataValueField("Value")
                    .DataTextField("Text")
                    .DataSource(source =>
                    {
                        source.Read(read =>
                        {
                            read.Action("GetRole", "Role");
                        })
                        .ServerFiltering(false);
                    })
                    .HtmlAttributes(new { style = "width:100%"}))
            </div>
            <label class="control-label col-sm-2">Mail CC</label>
            <div class="col-sm-4 col-md-4">
                @(Html.Kendo().MultiSelectFor(m => m.ListMailCC)
                    .Filter(FilterType.Contains)
                    .DataValueField("Value")
                    .DataTextField("Text")
                    .DataSource(source =>
                    {
                        source.Read(read =>
                        {
                            read.Action("GetRole", "Role");
                        })
                        .ServerFiltering(false);
                    })
                    .HtmlAttributes(new { style = "width:100%"}))
            </div>
        </div>
        <div class="form-group">
            <label class="control-label col-sm-2">Email Subject</label>
            <div class="col-sm-10 col-md-10">
                @*@Html.Kendo().TextBoxFor(model => model.Subject).HtmlAttributes(new { style = "width:100%", required = "required", maxlength = "160" })*@
                @(Html.Kendo().Editor()
                    .Name(Html.NameFor(m => m.Subject) + "_Editor")
                    .Tag("div")
                    .HtmlAttributes(new { style = "width: 100%;height:25px", data_bind = "value:Subject" })
                    .Immutables(immutables =>
                    {
                        immutables.SerializationHandler("immutablesSerializationEditor");
                        immutables.Deserialization("immutablesDeserializationEditor");
                    })
                    .Events(events => events.Select("onSelectEditor").Change(@"function (ev){
                        var hiddenInput =  $('#" + Html.NameFor(m => m.Subject) + @"');
                        hiddenInput.val(ev.sender.value());
                        hiddenInput.change();
                    }"))
                    .Serialization(serialization => serialization.Semantic(false))
                    .Tools(tools => tools.Clear()
                        .CustomTemplate(ct => ct.Template("<input id='TemplateToolFieldCodeSubject' style='width: 300px;' />"))
                    )
                )
                @Html.HiddenFor(m => m.Subject)
            </div>
        </div>
        <div class="form-group">
            <label class="control-label col-sm-2">Email Body</label>
            <div class="col-sm-10 col-md-10">
                @(Html.Kendo().EditorFor(m => m.Body)
                    //.Name(Html.NameFor(m => m.Body) + "_Editor")
                    .Encode(true)
                    .PasteCleanup(p => p
                        .Span(true)
                    )
                    //.Tag("div")
                    .HtmlAttributes(new { style = "width: 100%;height:300px" })
                    //.Immutables(immutables =>
                    //{
                    //    immutables.SerializationHandler("immutablesSerializationEditor");
                    //    immutables.Deserialization("immutablesDeserializationEditor");
                    //})
                    //.Events(events => events.Select("onSelectEditor").Change(@"function (ev){
                    //    var hiddenInput =  $('#" + Html.NameFor(m => m.Body) + @"');
                    //    hiddenInput.val(ev.sender.value());
                    //    hiddenInput.change();
                    //}"))
                    //.Serialization(serialization => serialization.Custom("customSerializationEditor"))
                    .Tools(tools => tools.Clear()
                        .Bold()
                        .Underline()
                        .JustifyLeft()
                        .JustifyCenter()
                        .JustifyRight()
                        .JustifyFull()
                        .Indent()
                        .Outdent()
                        .CreateLink()
                        .Unlink()
                        .TableEditing()
                        .ViewHtml()
                        .CustomTemplate(ct => ct.Template("<input id='TemplateToolFieldCodeBody' style='width: 300px;' />"))
                    )
                )
                @*@Html.TextBoxFor(m => m.Body)*@
            </div>
        </div>
    </div>
</div>
